#!/usr/bin/env bash
#shellcheck source=strict.bash
source ~/strict.bash
for installed_version in $(brew list | ag 'python@?'); do
	brew uninstall --force --ignore-dependencies "$installed_version"
done
for version in \
	latest:2 \
	latest:3.10 \
	latest:3.11 \
	latest; do
	asdf install python $version
done
for version in \
	2 \
	3.10 \
	3.11 \
	3.12; do
	asdf-uninstall-old python $version
done
asdf global python latest
asdf reshim python
pip install --upgrade pip
xargs pip install <"$HOME/.default-python-packages"
pipx reinstall-all
xargs -L 1 pipx install <"$HOME/Pipxfile"
pipx upgrade-all
asdf reshim python
"$HOME/.asdf/shims/register-python-argcomplete" --shell fish pipx >~/.config/fish/completions/pipx.fish
