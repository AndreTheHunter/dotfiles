#!/usr/bin/env fish
set -l start $PWD
source "$ASDF_DIR/asdf.fish"

function ls-files
    git ls-files --deduplicate --exclude-standard "$argv" "*/$argv" | sort --reverse
end

# Maven
for file in (ls-files 'pom.xml')
    show cd (path dirname $file)
    nofail mvn dependency:go-offline
    cd $start
end

# Yarn
for file in (ls-files 'yarn.lock')
    show cd (path dirname $file)
    nofail show yarn install
    cd $start
end

# NPM
for file in (ls-files 'package-lock.json')
    show cd (path dirname $file)
    nofail show npm install
    cd $start
end
